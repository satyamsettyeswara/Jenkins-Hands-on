Deploying Applications in Kubernetes using Jenkins
Goal:
âœ… Deploy an application to Kubernetes using Jenkins Pipelines
âœ… Use kubectl from Jenkins to deploy

ğŸ”¹ Step 1ï¸âƒ£: Configure Kubernetes in Jenkins
We need to allow Jenkins to access Kubernetes and deploy applications.

ğŸ”¹ Create a Service Account for Jenkins
1ï¸âƒ£ Run this command in your WSL terminal:

sh
Copy
Edit
kubectl create serviceaccount jenkins-deployer
2ï¸âƒ£ Bind this service account to the cluster-admin role:

sh
Copy
Edit
kubectl create clusterrolebinding jenkins-deployer-binding \
  --clusterrole=cluster-admin \
  --serviceaccount=default:jenkins-deployer
3ï¸âƒ£ Get the token for Jenkins:

sh
Copy
Edit
kubectl get secret $(kubectl get serviceaccount jenkins-deployer -o jsonpath='{.secrets[0].name}') -o jsonpath='{.data.token}' | base64 --decode
ğŸ”¹ Copy this token â†’ We will use it in Jenkins.

ğŸ”¹ Step 2ï¸âƒ£: Add Kubernetes Credentials to Jenkins
1ï¸âƒ£ Go to Jenkins â†’ Manage Jenkins â†’ Manage Credentials
2ï¸âƒ£ Under (global) credentials, click Add Credentials
3ï¸âƒ£ Select Type: Secret text

Secret: (Paste the token copied earlier)

ID: k8s-token

Description: Kubernetes API Token 4ï¸âƒ£ Click Save

ğŸ”¹ Step 3ï¸âƒ£: Write the Jenkins Pipeline
1ï¸âƒ£ Go to Jenkins â†’ New Item â†’ Pipeline
2ï¸âƒ£ Paste this pipeline:

groovy
Copy
Edit
pipeline {
    agent any
    environment {
        KUBE_TOKEN = credentials('k8s-token')
        KUBE_SERVER = 'https://kubernetes.default.svc'
    }
    stages {
        stage('Deploy to Kubernetes') {
            steps {
                sh '''
                echo "Starting Kubernetes Deployment..."
                echo $KUBE_TOKEN | kubectl --server=$KUBE_SERVER --token-stdin apply -f deployment.yaml
                '''
            }
        }
    }
}
3ï¸âƒ£ Click Build Now

âœ… If successful, your application should be deployed to Kubernetes! ğŸ‰
